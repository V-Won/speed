Malware Zero Kit

Virus Zero Season 2 : cafe.naver.com/malzero
Batch Script : ViOLeT (archguru)

경고 ! 타 사이트/카페/블로그/토렌트 등에서 재배포/개작 및 상업적 이용 절대 금지 ! (발견 시 신고 요망)

- - - - - - - - - - - - - - - - - - - - -

■ 문제 01. Malware Zero Kit 스크립트는 어떻게 실행해야 하나요?

   동봉되어 있는 <6. 사용 방법> 문서를 참고해주시기 바랍니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 02. "필수 파일이 존재하지 않거나 압축된 상태로 실행" 오류가 발생합니다.

   Malware Zero Kit 도구를 새로 내려받으신 후 압축을 해제하여 사용해주시기 바랍니다. (파일 및 폴더가 한 개라도 누락되면 오류 발생)

   ※ 압축된 상태에서 실행할 경우에도 동일한 오류가 발생하므로 반드시 압축을 해제하고 사용

- - - - - - - - - - - - - - - - - - - - -

■ 문제 03. "관리자가 명령 프롬프트를 사용하지 않도록 설정했습니다." 메시지가 발생합니다.

   mzk 폴더 내에 존재하는 unlock.reg 레지스트리를 실행하여 등록합니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 04. 악성코드가 발견은 되었으나 제거되지 않았습니다. 어떻게 해야 하나요?

   먼저 컴퓨터를 재부팅 또는 안전 모드로 부팅하신 후에 다시 한 번 검사를 시도해보시기 바랍니다.
   이후에도 제거에 실패하면 보안 제품(백신) 및 전용 백신 또는 강제 삭제 유틸리티를 사용하여 제거를 진행해주세요.

   ○ Kaspersky TDSSKiller : http://media.kaspersky.com/utilities/VirusUtilities/EN/tdsskiller.exe

   ※ 레지스트리 값의 경우에는 레지스트리 편집기(REGEDIT)를 사용하여 수동 제거하실 수 있습니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 05. 진단 및 삭제된 파일 및 폴더, 레지스트리가 정상 데이터입니다. 복원이 가능한가요?

   검역소 폴더(기본: C:\Quarantine)에서 복원 가능합니다.

   파일 및 폴더는 원본 파일명 뒤에 붙은 날짜와 vz 확장자를 제거하신 후, 리포트 파일을 참고하여 원래의 폴더에 복사해주세요.
   그리고, 레지스트리는 생성된 reg 확장자의 파일 내용을 확인하여 정상일 경우 실행 후 등록해주시면 복원됩니다.

   검역소 내 폴더 중 Files 폴더는 파일, Folders 폴더는 폴더, Registrys 폴더는 레지스트리 파일이 존재합니다.

   ※ 오진 발생 시, mzkhelp@gmail.com 으로 검역소 폴더를 7z 포맷으로 압축(비밀번호 설정 필수) 후 압축 파일을 첨부하여 신고해주세요.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 06. 안전 모드로 부팅하는 방법을 모르겠습니다. 어떻게 해야 하나요?

   [ Windows XP, Vista, 7 ]

   초기 Windows 부팅 화면이 나오기 바로 전 잠깐의 검은 화면 상태에서 F8 키를 누르면 나오는 고급 부팅 화면에서 선택

   [ Windows 8 ]

   설정(단축: 윈도우 + I 키) → PC 설정 변경 → 업데이트 및 복구 → 복구 → 고급 시작 옵션 → 다시 시작 → 문제 해결 → 고급 옵션 → 시작 설정 → 다시 시작 → 고급 부팅 화면에서 선택

- - - - - - - - - - - - - - - - - - - - -

■ 문제 07. 검사를 모두 완료한 후에 인터넷에 연결되지 않습니다. (재부팅 후에도 연결되지 않을 경우)

   악성코드에 의하여 시스템 파일 및 WINSOCK, TCP/IP, DHCP 서비스 또는 DNS 값 등이 변조 또는 손상된 경우 발생 가능하며, 아래의 절차를 수행하여 네트워크 환경을 복구합니다.

   ※ 변조된 시스템 파일이 복구되지 않아 증상이 발생할 경우 표준 환경으로 부팅하여 Windows 설치 미디어(CD/DVD) 삽입 후, 명령 프롬프트(CMD)를 관리자 권한으로 실행하신 다음 SFC /SCANNOW 명령어를 실행, 또는 <문제 13> 참고

   1) 아래 절차에 따라 'DNS' 설정을 확인 및 변경합니다. (Windows Vista 이상 기준)

      A. '제어판' → '네트워크 및 인터넷' → '네트워크 및 공유 센터' 실행  //  Windows XP = '네트워크 연결'
      B. '활성 네트워크 보기'의 '연결' 항목에서 '로컬(또는 무선) 영역 연결' 클릭 (명칭은 다를 수 있음)
      C. 로컬(또는 무선) 영역 연결 상태 창의 '일반' 탭에서 '속성' 버튼 클릭
      D. 속성 창의 '네트워킹' 탭에서 'Internet Protocol Version 4 (TCP/IPv4)' 항목 선택 후 '속성' 버튼 클릭  //  Windows XP = '인터넷 프로토콜(TCP/IP)'
      E. 속성 창의 '일반' 탭에서 하단 DNS 설정을 '자동으로 DNS 서버 주소 받기' 또는 '다음 DNS 서버 주소 사용'에 체크

         * '다음 DNS 서버 주소 사용'에 체크 시 입력해야 할 IP (통신사 또는 네트워크 환경마다 다를 수 있음)

         KT Olleh     = 기본 DNS : 168.126.63.1,   보조 DNS : 168.126.63.2
         SK Broadband = 기본 DNS : 210.220.163.82, 보조 DNS : 219.250.36.130
         LG U+ #1     = 기본 DNS : 164.124.101.2,  보조 DNS : 203.248.252.2
         LG U+ #2     = 기본 DNS : 164.124.107.9,  보조 DNS : 203.248.252.2
         LG U+ #3     = 기본 DNS : 61.41.153.2,    보조 DNS : 1.214.68.2
         Google       = 기본 DNS : 8.8.8.8,        보조 DNS : 8.8.4.4

      F. '확인' 버튼 클릭 후 인터넷 연결 확인

   2) Windows Vista 이상일 경우, '제어판' → '네트워크 및 인터넷' → '네트워크 및 공유 센터' 창 하단의 '문제 해결' 기능을 통해 점검 진행

   3) 공유기를 사용할 경우, 공유기 재부팅 또는 리셋 버튼을 누른 후 통신 가능 유무 확인

   4) 위의 항목 수행 후에도 연결되지 않을 경우 아래의 명령어를 순차 실행 후 재부팅

      IPCONFIG /REGISTERDNS
      IPCONFIG /FLUSHDNS
      IPCONFIG /RELEASE
      IPCONFIG /RENEW

   5) 4번 항목 수행 후에도 연결되지 않을 경우 아래의 명령어 실행 후 재부팅

      NETSH WINSOCK RESET

   6) 5번 항목 수행 후에도 연결되지 않을 경우 아래의 명령어를 실행 후 재부팅
      (기존 TCP/IP 설정을 수동으로 설정했을 경우 IP, DNS 및 게이트웨이 설정이 초기화되므로 재설정이 필요할 수 있음)

      NETSH INT IP RESET C:\LOG.TXT

   7) Windows Vista 이상(Vista, 7, 8 등)일 경우, 아래에 나열된 파일을 찾아 선택 후 오른쪽 클릭, '속성'을 실행한 다음에 보안 탭에서 '편집' 버튼 클릭

      Windows → System32 폴더 내 NSISVC.DLL
      Windows → System32 → wbem 폴더 내 WMISVC.DLL

      버튼 클릭 후 SYSTEM, Administrators, Users 그룹의 '읽기 및 실행' 권한이 '허용' 설정이 되어있지 않은지 확인하여 허용되어 있지 않을 경우 '허용'으로 설정

      설정 후 재부팅

   8) 7번 항목 수행 후에도 연결되지 않을 경우, 아래 절차에 따라 랜 카드의 '속도 및 이중' 설정 변경 (Windows Vista 이상 기준)

      A. '제어판' → '네트워크 및 인터넷' → '네트워크 및 공유 센터' 실행
      B. '활성 네트워크 보기' 항목에서 '로컬 영역 연결' 클릭 (명칭은 다를 수 있음)
      C. 로컬 영역 연결 상태 창의 '일반' 탭에서 '속성' 버튼 클릭
      D. 로컬 영역 연결 속성 창의 '네트워킹' 탭에서 '구성' 버튼 클릭
      E. 랜 카드 드라이버 속성 창의 '고급' 탭에서 '속도 및 이중' 항목을 선택 후 값을 <1Gbps 전이중/100Mbps 전이중/10Mbps 전이중> 중 한 가지를 선택 (기본값: 자동 교섭)
      F. '확인' 버튼을 누른 후 재부팅

   ※ 네트워크 어댑터 오동작 및 표시되지 않을 경우 <문제 08> 항목을 참고하여 해결

   ※ 어떠한 방법으로도 연결되지 않을 경우, 랜 카드 드라이버를 재설치 또는 운영체제를 이전 시점으로 복원

- - - - - - - - - - - - - - - - - - - - -

■ 문제 08. '네트워크 및 공유 센터'에서 네트워크 어댑터가 표시되지 않거나 동작하지 않을 경우 조치 방법

   1) 명령 프롬프트(CMD) 실행 후 아래의 명령어 실행 후 재부팅 (Vista 이상은 관리자 권한으로 실행)

      REGSVR32 NETSHELL.DLL
      REGSVR32 NETCFGX.DLL
      REGSVR32 NETMAN.DLL

   2) 문제가 해결되지 않을 경우, 아래 절차에 따라 수동으로 '드라이버 소프트웨어 업데이트' 수행 (문제가 발생한 모든 어댑터에 대해 동일한 방법으로 설정)

      A. '제어판' → '장치 관리자' 실행
      B. '네트워크 어댑터' 항목에서 노란색 느낌표 아이콘이 표시 된 장치 선택 후 오른쪽 버튼 클릭
      C. '드라이버 소프트웨어 업데이트' 클릭
      D. '컴퓨터에서 드라이버 소프트웨어 찾아보기' 클릭
      E. '컴퓨터의 장치 드라이버 목록에서 직접 선택' 클릭
      F. 현재 장치와 동일한 명칭의 드라이버 선택 후 '다음' 버튼 클릭

   3) 설정 후 재부팅

- - - - - - - - - - - - - - - - - - - - -

■ 문제 09. 실행 후 갑자기 종료되거나 특정 시점에서 장시간 멈추는 등 동작이 제대로 이루어지지 않습니다.

   mzk 폴더 내에 존재하는 unlock.reg 레지스트리를 실행/등록 후 실행해보시고, 이후에도 동일한 현상이 발생하는 경우에는 아래의 전용 백신을 1회 사용하여 악성코드를 치료한 후 재부팅 합니다.

   ○ Kaspersky TDSSKiller          : http://media.kaspersky.com/utilities/VirusUtilities/EN/tdsskiller.exe
   ○ AhnLab V3 OnlineGameHack Kill : http://download.ahnlab.com/vaccine/gamehackkill.exe

   재부팅이 완료되었으면 다시 검사를 시작합니다.

   ※ '지정된 파일을 찾을 수 없습니다.' 메시지가 표시된 후 종료되면 Cidox 부트킷에 감염된 상태일 수 있으므로 Kaspersky TDSSKiller 도구 사용 권장

- - - - - - - - - - - - - - - - - - - - -

■ 문제 10. 도구 실행 시 "이 파일을 열 수 없음(없습니다)" 오류가 발생합니다. 어떻게 해야 하나요?

   먼저 mzk 폴더 내에 존재하는 unlock.reg 레지스트리를 등록 후 다시 실행해보세요.

   등록 후에도 실행되지 않을 경우 Windows → System32 폴더 내에 존재하는 CMD.EXE(명령 프롬프트) 파일이 존재하는지 확인합니다.
   파일이 존재하지 않을 경우에는 악성코드에 의하여 삭제된 상태로, 아래의 파일을 내려받습니다.

   https://www.cubby.com/pl/FileRepair_CMD_KR.zip/_f51a11d2752541a8b89ec5557a741866

   파일을 내려받아 압축을 풀고 운영체제에 맞는 파일을 Windows 폴더 내 System32 폴더에 복사 후, 도구를 다시 실행합니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 11. 실행 후, 바탕 화면과 작업 표시줄이 사라집니다. 어떻게 해야 하나요?

   악성코드의 효과적인 제거를 위해 검사 초기에 Explorer 프로세스를 종료시키기 때문에 발생하는 걱정할 필요 없는 정상적인 현상입니다.
   종료된 Explorer 프로세스는 검사가 종료됨과 동시에 재실행됩니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 12. 실행 후, 아무 내용 없는 검은 창만 표시됩니다. 어떻게 해야 하나요?

   실행된 창의 제목 표시줄을 확인하셔서 실행된 경로 및 파일명을 확인해주세요.

   기본적으로 정상 명령 프롬프트(CMD) 파일은 Windows → System32 (또는 SysWOW64) 폴더 내부에 존재하지만, 해당 경로가 아닌 곳에서 CMD.EXE 파일이 실행되었다면 해당 파일을 삭제 후 다시 실행해주시기 바랍니다.

   ※ 만약, 다른 파일이 실행된다면 mzk 폴더 내에 존재하는 unlock.reg 레지스트리를 등록 후 다시 실행

- - - - - - - - - - - - - - - - - - - - -

■ 문제 13. 필수 시스템 파일이 존재하지 않거나 변조 의심으로 표시되었습니다. 어떻게 처리해야 하나요?

   1) 필수 시스템 파일이 존재하지 않을 경우 (DLL 파일의 경우만 해당)

      http://www.originaldll.com 또는 http://ko.dll-files.com

      위 사이트를 방문하여 파일명으로 검색, 자신의 OS에 맞는 버전으로 Windows 폴더 내 System32 또는 SysWOW64 폴더에 내려받습니다.
      (System32 혹은 SysWOW64 폴더에 내려받아야 하는지는 리포트 파일(report.log)에 기록)

   2) 필수 시스템 파일이 변조 의심으로 표시되었을 경우

      가장 먼저 바이러스 토탈(https://www.virustotal.com) 사이트를 방문하여 변조가 의심되는 파일을 올려 검사해주세요.

      만약, 의심 파일로 표시된 것이 정상 파일로 확인되는 경우에는 리포트 파일(report.log)에 기록된 MD5 값을 알려주시기 바랍니다.

      명확히 악성으로 판정되었다면 위의 1)항목 수행 또는 보안 업체에서 제공하는 전용 백신(아래)을 사용하여 치료를 진행합니다.

      ○ AhnLab V3 OnlineGameHack Kill          : http://download.ahnlab.com/vaccine/gamehackkill.exe
      ○ Hauri Sality/Virut/Parite Removal Tool : http://download.hauri.net/DownSource/down/dwn_antivirus_down.html?uid=100

- - - - - - - - - - - - - - - - - - - - -

■ 문제 14. 레지스트리 파일을 실행하면 "시스템 관리자가 레지스트리를 편집하지 못하도록 했습니다." 메시지가 발생합니다.

   1) 실행 창에 GPEDIT.MSC 를 입력 후 실행 (실행되지 않을 경우 X 항목 참고)

   2) 로컬 컴퓨터 정책 → 사용자 구성 → 관리 템플릿 → 시스템 항목으로 이동

   3) '레지스트리 편집 도구 사용 안 함' 항목을 찾아 두 번 클릭한 다음, 설정을 '구성되지 않음'으로 변경 후 '확인' 버튼 클릭

   X) GPEDIT.MSC 파일을 실행할 수 없는 버전인 경우, 명령 프롬프트(CMD) 실행하신 후에 아래의 명령어 입력 (Vista 이상은 관리자 권한으로 실행)

      REG DELETE HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableRegistryTools

- - - - - - - - - - - - - - - - - - - - -

■ 문제 15. 악성코드 치료/제거 후에 컴퓨터가 비정상적으로 느려졌습니다.

   악성코드가 남기고 간 흔적이나 악성코드에 의하여 디스크에 논리적인 오류가 발생한 경우에 나타나는 증상일 가능성이 크므로, 아래의 절차를 수행하여 디스크 오류를 제거합니다.

   1) 명령 프롬프트(CMD) 실행 (Vista 이상은 관리자 권한으로 실행)

   2) CHKDSK 입력 후 실행 (주의! 배드 섹터가 발견되면 이후의 검사는 중지)

   3) 오류가 발견될 경우, CHKDSK /F (더욱 정밀한 검사를 원할 경우 /F 대신 /R 로 변경) 입력 후 실행

   4) '다음에 시스템이 다시 시작할 때 이 볼륨을 검사하도록 하시겠습니까?' 메시지에서 Y 입력 후 엔터

   5) 재부팅 (운영체제 구동 중간에 디스크 검사 수행, 시간 다소 소요)

- - - - - - - - - - - - - - - - - - - - -

■ 문제 16. 인터넷 익스플로러 브라우저가 정상적으로 동작하지 않습니다. 어떻게 해야 하나요?

   제어판 → 네트워크 및 인터넷 → 인터넷 옵션 → 고급 탭 → 원래대로 버튼을 통해 브라우저를 초기화 해주시기 바랍니다.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 17. 인터넷 브라우저로 사이트 방문시 3분 이상 기다려야 페이지가 표시되는 현상이 발생합니다. 어떻게 해야 하나요?

   현재 설치되어 있는 플래시 플레이어(Adobe Flash Player)의 충돌 문제일 수 있으므로, 플래시 플레이어를 삭제 후 재설치를 진행해보세요.

- - - - - - - - - - - - - - - - - - - - -

■ 문제 18. 기타 발생할 수 있는 여러가지 문제점을 해결하려면?

   ○ Microsoft Fix it 솔루션 센터 : http://support.microsoft.com/fixit

- - - - - - - - - - - - - - - - - - - - -

■ 문제 19. 악성코드 감염이 의심되지만 전혀 탐지되지 않습니다. 어떻게 해야 하나요?

   사용하고 계시는 보안 제품의 업체에 문의하시거나 아래의 게시물을 참고하시면 악성코드 제거에 도움이 될 것입니다.

   ○ 악성코드 분석 요청 : http://cafe.naver.com/malzero/98809

- - - - - - - - - - - - - - - - - - - - -